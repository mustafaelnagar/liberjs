/**
 * @author soyoes 
 * @Copywrite (c) 2013, Liberhood, http://liberhood.com 
 * @URL : https://github.com/soyoes/liberjs
 * @license : MIT License
 */

function $id(e){var t="loaded"===$app.status&&$this&&$this.layer;return t?$this.layer.find("#"+e):document.getElementById(e)}$conf=$conf||{},$browser=function(){var e,t=navigator.appName,n=navigator.userAgent,r=n.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);r&&null!=(e=n.match(/version\/([\.\d]+)/i))&&(r[2]=e[1]),r=r?[r[1],r[2]]:[t,navigator.appVersion,0];var a=n.match(/(iPhone|iPod|Android)/i),i={name:r[0],version:parseInt(r[1]),device:a?"smartphone":"pc"},o=navigator.appVersion,s={Win:"windows",Mac:"mac",X11:"linux",Linux:"linux"};for(var l in s)if(o.indexOf(l)>=0){i.os=s[l];break}return"MSIE"!=i.name||window.atob||$app.onError&&$app.onError("unsupported_error"),i}(),$=function(e,t){var n="loaded"===$app.status&&$this&&$this.layer,r=n?$this.layer.find(e):document.querySelectorAll(e);if(r){t&&r.each(t);var a=e.split(" "),i=a[a.length-1];r=0==i.indexOf("#")?r[0]:r}return r},$.args=null,$.__runtimeIdx=0,$.__events={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|touch(start|end|up|cancel)|mouse(?:down|up|over|move|out))$/},$.__eventOpts={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0},$.__HTML_ESC={"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},$.__HTML_UESC={"&":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'"},__={},__set=function(e,t,n){__[e]=t,n=n||300,setTimeout(function(e){delete __[e]},n,e)},__clear=function(){__={}};var $this;$.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},$.isFunc=function(e){var t={};return e&&"[object Function]"===t.toString.call(e)},$.isBool=function(e){return e===!0||e===!1},$.isElement=function(e){try{return e instanceof HTMLElement||e instanceof SVGElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}},$.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},$.isString=function(e){return"string"==typeof e||e instanceof String},$.isObject=function(e){return"object"==typeof e},$.keys=function(e){var t=[];if($.isObject(e))for(var n in e)t.push(n);return t},$.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},$.unique=function(e){var t=[];for(var n in e)t.indexOf(e[n])<0&&t.push(e[n]);return t},$.trim=function(e,t){for(var n=[],r=0;r<e.length;r++){var a=e[r];t?t(a)&&n.push(a):(0===a||null!=a&&void 0!=a&&""!=a)&&n.push(a)}return n},$.range=function(e,t){if(!e)return!1;var n,r,a,i;for(i=0;i<e.length;i++)a=t?e[i][t]:e[i],n||(n=a,r=a),n>a&&(n=a),a>r&&(r=a);return[n,r]},$.getArguments=function(){if($.args)return $.args;var e=document.getElementsByTagName("script");$.args={};for(var t in e){var n=e[t];if(n.src.indexOf("liber.js")>=0){var r=n.src.split("liber.js"),a=r[1];if(0==a.indexOf("?")){a=a.replace("?",""),r=a.split("&");for(var i in r){var o=r[i].split("=");$.args[o[0]]=o[1]}}return $.args}}},$.getCookie=function(e){if(document.cookie){var t=$.unserialize(document.cookie,";");return t[e]}return null},$.unserialize=function(e,t,n){if(!e)return null;t=t||"&",n=n||"=",e=e.replace(/(.*)\?/i,"");var r=e.split(t),a={};for(var i in r){var o=r[i].split(n);2==o.length&&(a[o[0].trim()]=o[1])}return a},$.serialize=function(e,t,n){var r=[];t=t||"&",n=n||"=";for(var a in e)r.push([a,e[a]].join(n));return r.join(t)},$.preload=function(e,t,n){for(var r=0;r<e.length;r++){var a=e[r];0!=a.indexOf("http")&&$conf.preload_image_path&&0!=a.indexOf($conf.preload_image_path)&&(a=$conf.preload_image_path+a);var i=new Image;t&&(i.onload=function(e){e=e||window.event;var n=e.target||e.srcElement;t(n.src)}),n&&(i.onerror=function(e){e=e||window.event,n(e.target||e.srcElement)}),i.src=a}},$.keyCode=function(e){return document.all?e.keyCode:$id?e.keyCode?e.keyCode:e.charCode:document.layers?e.which:void 0},$.clone=function(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):$.isArray(e)?e.slice(0):e},$.include=function(e,t,n){e.indexOf(".js")<0&&(e+=".js"),e.indexOf("/")<0&&(e=$conf.liber_path+e);var r=e.split("/");r=r[r.length-1].replace(/\./g,"_");var a=(new Date).getTime();if($id(r,!0))t&&("function"==typeof t?t(n):"string"==typeof t&&(t=window[t],t&&t(n)));else{var i=t,o=n,s=function(e){$app.__included||($app.__included=[]),e=e||window.event;var t=e.target||e.srcElement;if("loading"!=t.readyState){if("error"==e.type)throw $app.onError&&$app.onError("app_include_error",t.src),new Error("ERROR : Failed to load "+t.src);t.onload=t.onreadystatechange=null,$app.__included.push(t.id),i&&i(o)}},l=document.createElement("script");l.id=r,l.type="text/javascript",l.onload=l.onreadystatechange=s,l.onerror=s;var p=document.head?document.head:document.getElementsByTagName("head")[0];document.head?(p.appendChild(l),l.src=e.indexOf("liber.")>=0?e+"?v="+a:e):(l.src=e.indexOf("liber.")>=0?e+"?v="+a:e,p.appendChild(l))}},$.extend=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},$.log=function(e,t){if($conf.log_path){var n=$.serialize(t);e=[$this.name,e].join("/"),$http&&$http.get([log_path,"/",e,"?",n].join(""))}},$.rand=function(e,t){var n=arguments.length;return 0===n?(e=0,t=2147483647):1===n&&(t=e,e=1),Math.floor(Math.random()*(t-e+1))+e},$.keygen=function(e,t){e=e||16,t=t||"abcdefghijklmnopqrstuvwxyz0123456789_.;,-$%()!@";for(var n=[],r=t.length,a=0;e>a;a++)n.push(t[$.rand(0,r-1)]);return n.join("")},$.uuid=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return t},$.documentHeight=function(){var e=document.documentElement?document.documentElement:document.body;return Math.max(e.scrollHeight,e.offsetHeight,e.clientHeight)},$.screenWidth=function(){return window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth},$.screenHeight=function(){return window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight},$.cursor=function(e){return $.__mouseX=0,$.__mouseY=0,e.pageX||e.pageY?($.__mouseX=e.pageX,$.__mouseY=e.pageY):($.__mouseX=e.clientX+document.body.scrollLeft,$.__mouseY=e.clientY+document.body.scrollTop),{x:$.__mouseX,y:$.__mouseY}},$.inRect=function(e,t){return e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height},$.uploadWindow=function(e,t){var n="__tmpFileForm",r="__tmpFileBtn",a=$id(n,!0);if(void 0==a){a=$form({id:n,enctype:"multipart/form-data"},document.body).css({border:"0px",height:"0px",width:"0px",display:"none"});var i={id:r,type:"file",name:"tempfile"};t&&(i.multiple="multiple");var o=$input(i,a);o.bind("change",e),o.fire("click")}else a.style.display="block",$id(r).fire("click"),setTimeout(function(){$id(n,!0).style.display="none"},100)};var $app={status:"normal",viewIdx:1,views:[],start:function(start_view){if("stopped"==$app.status)throw new Error("This app has been stopped for some reason.");if($app.start_view=$.isString(start_view)?start_view:$conf.default_view,!$app.start_view)throw $app.onError&&$app.onError("no_start_view_error"),new Error("No start view");var __default={modules:[],liber_path:"/js/"};for(var i in __default)$conf[i]||($conf[i]=__default[i]);window.onhashchange=function(e){var hash=window.location.hash;if(hash.startsWith("#"))if(hash=hash.replace(/^#/,""),hash.match(/^~/)){var func=hash.replace(/^~/,"");try{eval(func+"()")}catch(ex){$app.onError&&$app.onError("wrong_func_url_error")}}else{var vname=hash.split("?")[0];window[vname]&&window[vname].drawContent&&$app.openView(hash)}};var images=$conf.preload_images?$conf.preload_images:[],loadFiles=$conf.modules.length+images.length,loadedFiles=0;if(0==loadFiles)return $app.preloaded();var step=function(){loadedFiles++;var e=parseInt(100*loadedFiles/loadFiles);$app.onLoadProgress&&$app.onLoadProgress(e),e>=100&&$app.preloaded()};for(var i in $conf.modules)$.include($conf.modules[i],step,$conf.modules[i]);images.length>0&&$.preload(images,step,step)},stop:function(){$app.status="stopped",$("body > article.layer",function(e){e.parentNode.removeChild(e)})},preloaded:function(){$app.onLoad?$app.onLoad():$app.loaded()},loaded:function(){$app.status="loaded",$app.openView($app.start_view)},handle:function(e,t){switch(e){case"stop":return $app.stop();case"loaded":return $app.drawView(t);case"close":return $app.closeView(t);case"front":return $app.bringViewToFront(t)}},trans:function(e){e=e||window.event;var t=e.target||e.srcElement,n=t.getAttribute("url");n&&$.isString(n)&&(n.match(/@\?*/g)?$app.openView(n.replace("@?","?"),!0):"A"!=t.tagName?$a({href:"#"+n,html:"_"},document.body).css({opacity:0}).fire("click"):t.fire("click"))},openView:function(e,t){if(!e||!$.isString(e))throw $app.onError&&$app.onError("unsupported_url_type_error",{url:e}),new Error("ERROR : $app.openView requires string type url");if(0==e.indexOf("http:")||0==e.indexOf("https:"))return location.href=e;var n=$.unserialize(e),r=e.split("?")[0],a=$this;r.endsWith("@")&&(t=!0,r=r.substring(0,r.length-1));var i=window[r];if(!i)throw $app.onError&&$app.onError("view_not_exists_error",{name:r}),new Error("Error :no view("+r+") to enhance");i.close&&i.loaded||(i.name=i.name||r,$.extend(i,$controller)),i.params=n,t&&a&&(i.opener=a.name),$this=i,$app.views.push(r),a&&a.onInactive&&a.onInactive.call(a,i),i.onLoad?i.onLoad.call(i,n):i.loaded()},drawView:function(e){e&&(e.reusable&&e.layer?(e.layer&&!e.layer.parentNode&&document.body.appendChild(e.layer),$app.bringViewToFront(e),e.onActive&&(e.onActive.call(e,$app.last_view?window[$app.last_view]:null),$app.last_view=null)):(e.opener||$app.hideOthers(e),e.drawView.call(e,$app.viewIdx++)))},closeView:function(e){if(e.onClose&&e.onClose(),e.layer&&e.layer.remove(),$app.views.pop(),e.opener)e.opener=!1,$app.last_view=e.name;else{for(var t,n=$app.views.length-1;n>=0;n--){var r=window[$app.views[n]];if(r.layer&&"none"==r.layer.style.display){t=r;break}}t=t||window[$app.start_view],t.layer.show()}$this=$app.views.length>=1?window[$app.views.pop()]:window[$app.start_view],$this&&$this.onActive&&($this.onActive.call($this,$app.last_view?window[$app.last_view]:null),$app.last_view=null)},bringViewToFront:function(e){for(var t=[],n=0;n<$app.views.length;n++)e.name!=$app.views[n];t.push($app.views[n]),t.push(e.name),$app.views=t,e.layer.css({display:"block",zIndex:100+$app.viewIdx++})},hideOthers:function(e){for(var t=0;t<$app.views.length;t++){var n=window[$app.views[t]];$app.views[t]!=e.name&&n.layer.hide()}}},$controller={loaded:function(){$app.handle("loaded",$this)},close:function(){$app.handle("close",$this)},reload:function(e){this.params=e||this.params,this.onLoad?this.onLoad.call(this,this.params):this.loaded()},drawView:function(e){var t=this,n=$article({idx:e,"class":t.opener?"view popup "+t.name:"view "+t.name,view:t.name},document.body);if(n.css({width:"100%",height:"100%",zIndex:100+e,position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",margin:"0px",border:"0px",padding:"0px",textAlign:"center"}),!t.noHeader){var r=$header({},n);r=t.drawHeader?t.drawHeader.call(t,r,n):$app.drawHeader?$app.drawHeader(r):r}var a=$section({},n);if(t.drawContent&&(t.layer&&t.layer.remove(),t.layer=n,t.content=a,t.drawContent.call(t,a,n)),!t.noFooter){var i=$footer({},n);i=t.drawFooter?t.drawFooter.call(t,i,n):$app.drawFooter?$app.drawFooter(i):i}},bringToFront:function(){$app.handle("front",$this)}};String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.substring(1)},String.prototype.toHex=function(){for(var e=[],t=this.length,n=0;t>n;n+=1){var r=this.charCodeAt(n);e.push(r.toString(16))}return e.join("")},String.prototype.getByte=function(){for(var e=0,t=0;t<this.length;t++){var n=escape(this.charAt(t));n.length<4?e++:e+=2}return e},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.CJKLength=function(){var e=escape(this).replace(/%u.{4}/gm,"1");return e.length},String.prototype.splice=function(e,t,n){return this.slice(0,e)+n+this.slice(e+Math.abs(t))},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.slice(-e.length)==e}),String.prototype.escape=function(){var e=new RegExp("["+$.keys($.__HTML_ESC).join("")+"]","g");return this.replace(e,function(e){return $.__HTML_ESC[e]})},String.prototype.unescape=function(){var e=new RegExp("("+$.keys($.__HTML_UESC).join("|")+")","g");return this.replace(e,function(e){return $.__HTML_UESC[e]})},NodeList.prototype.each=function(e){if(e)for(var t=0;t<this.length;t++)e(this[t],t);return this},NodeList.prototype.callfunc=function(e,t,n){var r=e&&("string"==typeof e||e instanceof String)?Element.prototype[e]:!1;if(r)for(var a=0;a<this.length;a++)r.call(this[a],t,n);return this},NodeList.prototype.attr=function(e,t){return this.callfunc("attr",e,t)},NodeList.prototype.css=function(e,t){return this.callfunc("css",e,t)},NodeList.prototype.bind=function(e,t){return this.callfunc("bind",e,t)},NodeList.prototype.hide=function(){return this.callfunc("hide")},NodeList.prototype.show=function(){return this.callfunc("show")},NodeList.prototype.addClass=function(e){return this.callfunc("addClass",e)},NodeList.prototype.removeClass=function(e){return this.callfunc("removeClass",e)};var $deltas={linear:function(e){return e},quad:function(e){return Math.pow(e,2)},quad5:function(e){return Math.pow(e,5)},circ:function(e){return 1-Math.sin(Math.acos(e))},back:function(e,t){return t=t||1.5,Math.pow(e,2)*((t+1)*e-t)},bounce:function(e){for(var t=0,n=1;1;t+=n,n/=2)if(e>=(7-4*t)/11)return-Math.pow((11-6*t-11*e)/4,2)+Math.pow(n,2)},elastic:function(e,t){return t=t||.1,Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)},easeOut:function(e){return"string"==typeof e&&(e=$deltas[e]),function(t){return 1-e(1-t)}},easeInOut:function(e){return"string"==typeof e&&(e=$deltas[e]),function(t){return.5>=t?e(2*t)/2:(2-e(2*(1-t)))/2}}},__element={isSvg:function(){return window.__svgTagIndex=window.__svgTagIndex||__tags.indexOf("svg"),__tags.indexOf(this.tagName.toLowerCase())>=window.__svgTagIndex},addClass:function(e){if(this.isSvg()){var t=this.getAttribute("class")||"";t=t.length>0?t+" ":"",this.setAttribute("class",t+e)}else this.className.indexOf(e)<0&&(this.className+=" "+e);return this},removeClass:function(e){if(!e)return this;e=e.trim();var t=this.isSvg(),n=t?this.getAttribute("class"):this.className;return n=n.replace(new RegExp("\\b"+e+"\\b","g"),"").replace(/\s+/g," "),t?this.setAttribute("class",n):this.className=n,this},hasClass:function(e){var t=this.isSvg(),n=t?this.getAttribute("class"):this.className;return n&&new RegExp("\\b"+e+"\\b","g").test(n)},css:function(e,t){if("string"==typeof e){if(void 0===t)return this.style[e];e.indexOf("background")>=0&&t.indexOf("url(")>=0&&$conf.image_path&&t.indexOf("data:image")<0&&t.indexOf("http")<0&&(t=t.replace("url(","url("+$conf.image_path)),"Firefox"==$browser.name?this.style.setProperty(e,t):this.style[e]=t}else if("object"==typeof e&&!t)for(var n in e)this.css(n,e[n]);return this},attr:function(e,t){if("string"==typeof e){if("var"==e)return __set(t,this),this;if("id"==e)return this.id=t,__set(t,this),this;if("html"==e&&(e="innerHTML"),this.isSvg()||"class"!=e&&"classname"!=e||(e="className"),"url"==e&&"string"==typeof t&&this.bind("click",$app.trans),void 0==t)return this.getAttribute(e);this[e]="IMG"==this.tagName.toUpperCase()&&"src"==e.toLowerCase()&&$conf.image_path&&t.indexOf("data:image")<0&&0!=t.indexOf("http")?$conf.image_path+t:t,"function"==typeof t||$.isBool(t)||"innerHTML"!=e&&"className"!=e&&"src"!=e&&this.setAttribute(e,t)}else if("object"==typeof e&&!t)for(var n in e)"function"==typeof e[n]?this.bind(n,e[n]):this.attr(n,e[n]);return this},handle:function(e){e=e||window.event;var t=this||e.target||e.srcElement,type=e.type,handlers=t.attr("__on"+type);if("smartphone"==$browser.device)switch(type){case"touchstart":this.attr("__touchSX",e.changedTouches[0].pageX),this.attr("__touchSY",e.changedTouches[0].pageY);break;case"touchend":var th=JSON.parse(t.attr("__ontap")),x=e.changedTouches[0].pageX,y=e.changedTouches[0].pageY,ox=parseFloat(this.attr("__touchSX")),oy=parseFloat(this.attr("__touchSY"));if(th&&th.length>0&&Math.abs(ox-x)+Math.abs(oy-y)<=10)for(var i=th.length-1;i>=0;i--){var o=eval("("+th[i]+")");o&&o.call(t,e)}this.removeAttribute("__touchSX"),this.removeAttribute("__touchSY")}if(handlers){handlers=JSON.parse(handlers);for(var i=handlers.length-1;i>=0;i--){var o=eval("("+handlers[i]+")");o&&o.call(t,e)}}},find:function(e){var t=e.split(" "),n=t[t.length-1],r=this.querySelectorAll(e);return 0==n.indexOf("#")?r[0]:r},bind:function(e,t){if("string"==typeof e){if(t){e=e.replace(/^on/,"");var n=this.attr("__on"+e),r=t.toString();n?(n=JSON.parse(n),n.push(r)):n=[r],this.attr("__on"+e,JSON.stringify(n));for(var a="tap"!=e&&"touch"!=e||"smartphone"!=$browser.device?[e]:["touchstart","touchend"],i=0;i<a.length;i++)this.addEventListener(a[i],this.handle,!1)}}else if("object"==typeof e&&!t)for(var o in e)o=o.replace(/^on/,""),this.bind(o,e[o]);return this},unbind:function(e){return this.removeAttribute("__on"+e),this},clone:function(e){var t=this.cloneNode(!0);return e&&e.appendChild(t),t},rect:function(){var e=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft;if(this.getBoundingClientRect){var n=this.getBoundingClientRect();return{top:n.top+e,width:n.width,left:n.left+t,height:n.height}}for(var r=0,a=0,i=this.width(),o=this.height(),s=this;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)r+=s.offsetLeft-s.scrollLeft,a+=s.offsetTop-s.scrollTop,s=s.offsetParent;return{top:a+e,left:r+t,width:i,height:o}},height:function(){return Math.max(this.clientHeight||0,this.scrollHeight||0,this.offsetHeight||0)},width:function(){return Math.max(this.clientWidth||0,this.scrollWidth||0,this.offsetWidth||0)},hide:function(e){return this.style.display&&this.attr("__orgDisplay",this.style.display),e>0?this.animate({duration:e,style:"easeIn",step:function(e,t){e.style.opacity=1-t,t>=1&&(e.style.opacity=1,e.style.display="none")}}):this.style.display="none",this},show:function(e){return e>0?this.css({display:this.attr("__orgDisplay")||"block",opacity:0}).animate({duration:e,style:"easeOut",step:function(e,t){e.style.opacity=t,t>=1&&(e.style.display=e.attr("__orgDisplay")||"block")}}):this.style.display=this.attr("__orgDisplay")||"block",this},toggle:function(e){return"none"==this.style.display?this.show(e):this.hide(e)},remove:function(){this.parentNode&&this.parentNode.removeChild(this)},before:function(e){return $.isElement(e)&&e.parentNode&&e.parentNode.insertBefore(this,e),this},after:function(e){return $.isElement(e)&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(this,e.nextSibling):e.parentNode.appendChild(this)),this},selectable:function(e){return e=e===!1?"none":e===!0?"all":e,this.bind("selectstart",function(e){return e.preventDefault()}).css({"-moz-user-select":e,"-webkit-user-select":e,"-ms-user-select":e,"user-select":e})},animate:function(e){var t=this;if(e.delay){var n=parseInt(e.delay);return delete e.delay,setTimeout(function(e){e.ele&&e.ele.animate(e.opts)},n,{ele:t,opts:e}),t}var r=Date.now();e.duration=e.duration||1e3,e.frame=e.frame||60,e.interval=1e3/e.frame,e.delta=e.delta||"linear";var a=setInterval(function(){var n=new Date-r,i=n/e.duration;i>1&&(i=1);var o=$deltas[e.delta];e.style&&("easeOut"==e.style&&(o=$deltas.easeOut(o)),"easeInOut"==e.style&&(o=$deltas.easeInOut(o)));var s=o(i);e.step(t,s),1==i&&clearInterval(a)},e.interval);return this},hover:function(over,out){return over&&(this.attr({__over:"("+over.toString()+")",__exec:"no"}),this.bind({mouseover:function(e){e=e||window.event;var t=e.target||e.srcElement,f=eval(t.attr("__over"));return f&&"no"===t.attr("__exec")?(t.attr("__exec","yes"),void f(e,t)):e.preventDefault()&&!1}})),out&&(this.attr({__out:"("+out.toString()+")"}),this.bind({mouseout:function(e){e=e||window.event;var t=e.target||e.srcElement,rect=t.rect();if($.inRect($.cursor(e),rect))return e.preventDefault()&&!1;var out=eval(t.attr("__out"));out&&(t.attr({__exec:"no"}),out(e,t))}})),this},fire:function(e,t){var n=$.extend($.__eventOpts,t||{}),r=null,a=null;for(var i in $.__events)if($.__events[i].test(e)){a=i;break}if(!a)throw $app.onError&&$app.onError("event_fire_error",{name:e}),new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");if(this[e])this[e]();else if(document.createEvent)r=document.createEvent(a),"HTMLEvents"===a?r.initEvent(e,n.bubbles,n.cancelable):r.initMouseEvent(e,n.bubbles,n.cancelable,document.defaultView,n.button,n.pointerX,n.pointerY,n.pointerX,n.pointerY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,this),this.dispatchEvent(r);else{n.clientX=n.pointerX,n.clientY=n.pointerY;var o=document.createEventObject();r=$.extend(o,n),this.fireEvent("on"+e,r)}return this}};"function"==typeof Element.prototype.animate&&(Element.prototype.animate=__element.animate),$.extend(Element.prototype,__element);for(var $e=function(e,t,n,r){e=r?e.replace(/_/g,"-"):e;var a=r?document.createElementNS(r,e):document.createElement(e);if(n&&"string"==typeof n&&(n=$id(n)),t){var i=typeof t;if("string"==i)switch(e){case"img":a.src=$conf.image_path&&t.indexOf("data:image")<0&&t.indexOf("http")<0?$conf.image_path+t:t;break;case"a":a.href=t;break;default:a.innerHTML=t}else if($.isArray(t)){for(var o in t)if(null!=t[o])if($.isElement(t[o]))a.appendChild(t[o]);else if($.isFunc(t[o])){var s=a,l=t[o]();if($.isArray(l))for(var p in l)$.isElement(l[p])&&s.appendChild(l[p]);else $.isElement(l)&&s.appendChild(l);a=s}else $app.onError&&$app.onError("invalid_child_error")}else if($.isElement(t))a.appendChild(t);else{if($.isFunc(t))return $e(e,t(),n);if("object"==i)for(var c in t){var u=t[c];"function"==typeof u?a[c]=u:a.attr(c,u)}}}return n&&"function"!=typeof n&&n.appendChild(a),a},__tags=["div","p","span","br","hr","ul","ol","li","dl","dt","dd","article","section","aside","footer","header","nav","table","caption","tbody","thead","tfoot","colgroup","col","tr","td","th","form","fieldset","legend","input","label","textarea","select","option","b","h1","h2","h3","h4","h5","h6","cite","pre","s","u","i","mark","q","small","sub","sup","abbr","bdo","time","em","dfn","code","samp","strong","kbd","var","map","area","figure","figcaption","a","img","button","progress","address","base","canvas","embed","audio","video","source","progress","svg","altglyph","altglyphdef","altglyphitem","animate","animateColor","animateMotion","animateTransform","circle","clippath","color_profile","cursor","defs","desc","ellipse","feblend","fecolormatrix","fecomponenttransfer","fecomposite","feconvolvematrix","fediffuselighting","fedisplacementmap","fedistantlight","feflood","fefunca","fefuncb","fefuncg","fefuncr","fegaussianblur","feimage","femerge","femergenode","femorphology","feoffset","fepointlight","fespecularlighting","fespotlight","fetile","feturbulence","filter","font","font_face","font_face_format","font_face_name","font_face_src","font_face_uri","foreignobject","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","missing_glyph","mpath","path","pattern","polygon","polyline","radialgradient","rect","script","set","stop","style","switch","symbol","text","textpath","tref","tspan","use","view","vkern"],_ns="",i=0;i<__tags.length;i++){var tag=__tags[i];"svg"==tag&&(_ns=",'http://www.w3.org/2000/svg'"),eval(["window.$",tag,"=",tag.toUpperCase(),"= function(args,target){ return $e('",tag,"', args,target",_ns,"); };"].join(""))}var $sel=function(e,t,n){window._sel_handler||(window._sel_handler=function(e){e=e||window.event;var t=e.target||e.srcElement,n="LI"==t.tagName.toUpperCase()?t:t.parentNode;t=n.childNodes[0];var r=n.name,a=$id(r+"-input"),i=n.attr("value"),o=1==n.attr("multiple");if(o){n.className.match(/\son$/)?(n.className=n.className.replace(/\son$/g,""),t.className=t.className.replace(/\son$/g,"")):(n.className+=" on",t.className+=" on");var s=[];$("#"+r+"-list .on",function(e){"LI"==e.tagName.toUpperCase()&&s.push(e.getAttribute("value"))}),a.value=s.join(",")}else i==a.value?a.value="":($("#"+r+"-list .on",function(e){e.className=e.className.replace(/\son$/,"")}),n.className+=" on",n.childNodes[0].className+=" on",a.value=i)});var r=t.value&&t.multiple?"#"+t.value.split(",").join("#,#")+"#":t.value||"",a=1==t.multiple||1==t.multiple,i=$div({id:t.id},n),o=$ul({id:t.id+"-list"},i),s=0,l=t.eventType||"click",p=t.drawOption;for(var c in e){var u=a?r.indexOf("#"+c+"#")>=0?" on":"":t.value==c?" on":"",d=1==t.noLabel?{className:t.labelClass?t.labelClass+u:u,html:"&nbsp;"}:{className:t.labelClass?t.labelClass+u:u,html:e[c]},f=$li([$div(d)],o).attr({name:t.id,value:c,idx:s,multiple:a?1:0,className:t.optionClass?t.optionClass+u:u}).bind(l,window._sel_handler);p&&p(f,s),s++}return $input({name:t.name,id:t.id+"-input",className:t.formId?"form-item-"+t.formId:"",type:"hidden",value:t.value?t.value:""},i),i},$radio=function(e,t,n){return delete t.multiple,$sel(e,t,n)},$checkbox=function(e,t,n){return t.multiple=1,$sel(e,t,n)},$select=function(e,t,n){if("MSIE"==$browser.name&&$browser.version<9&&t.name){var r=document.createElement(["<select name=",t.name,"></select>"].join("'"));r.attr(t),n&&n.appendChild(r)}else r=$e("select",t,n);if($.isArray(e))for(var a in e)$e("option",{value:e[a],html:e[a]},r);else for(var i in e)$e("option",{value:i,html:e[i]},r);return t.value&&(r.value=t.value),r},$styles=function(e,t,n){t=t||document.body;var r=n?n:"runtime_rule_"+ ++$.__runtimeIdx,a=$e("style",{type:"text/css",id:r},t),i=document.createTextNode("");if("string"==typeof e)i.appendData(e);else for(var o in e){var s="string"==typeof e[o]?e[o]:$.serialize(e[o],";",":");i.appendData([o,"{",s,"}\n"].join(""))}return a.appendChild(i),r},$http={getRequest:function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},ajax:function(e,t,n,r,a,i){t=$conf.http_host&&0!=t.indexOf("http")?$conf.http_host+t:t;var o=$http.getRequest();a||(a="json"),o.runtimeParams={callback:r,format:a},i&&(o.runtimeParams.onprogress=i);var s=!1;"UPLOAD"==e&&(e="POST",s=!0,o.upload.addEventListener("progress",function(e){var t=parseInt(100-e.loaded/e.total*100);o.runtimeParams.onprogress&&o.runtimeParams.onprogress(t)},!1)),o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){if(o.runtimeParams.callback){var e=o.responseText;if("json"==o.runtimeParams.format)try{e=JSON.parse(e)}catch(t){return $app.onError&&$app.onError("http_parse_error",{data:e}),o.runtimeParams.callback(null,{message:"json_error",data:e})}o.runtimeParams.callback(e)}}else{var n={code:o.status,message:o.getResponseHeader("ERROR_MESSAGE")};o.runtimeParams.callback&&o.runtimeParams.callback(null,n),$app.onError&&$app.onError("http_server_error",n)}};var l="";if(n){var p=[];for(var c in n){var u=n[c]+"";c=encodeURIComponent(c),u=s?u:encodeURIComponent(u),p.push(c+"="+u)}if(l=p.join("&"),"GET"==e){var d=t.indexOf("?")>0?"&":"?";t+=d+l}}e=e.toUpperCase(),o.open(e,t,!0),"POST"==e||"PUT"==e||"DELETE"==e?(o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(l)):o.send()},get:function(e,t,n,r){$http.ajax("GET",e,t,n,r)},post:function(e,t,n,r){$http.ajax("POST",e,t,n,r)},put:function(e,t,n,r){$http.ajax("PUT",e,t,n,r)},del:function(e,t,n,r){$http.ajax("DELETE",e,t,n,r)},upload:function(e,t,n,r,a){$http.ajax("UPLOAD",e,t,n,r,a)}};
